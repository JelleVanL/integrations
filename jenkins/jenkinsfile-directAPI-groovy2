import groovy.json.JsonSlurper

def CONFIG_DIR = "<DIRECTORY OR FILE WHERE YOU PUT YOUR CONFIG TO UPLOAD TO SWEAGLE> ex: ./conf"
def SWEAGLE_TENANT = "<YOUR SWEAGLE TENANT> ex: https://testing.sweagle.com"
def SWEAGLE_TOKEN = "<YOUR API TOKEN, ENSURE IT HAS SUFFICIENT PRIVILEGES> ex: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
def SWEAGLE_PATH = "<PATH IN DATA MODEL WHERE YOU WANT TO PUT YOUR CONFIG DATA> ex: dimension,node1,node2"
def SWEAGLE_MDS = "<METADATASET YOU WANT TO GET CONFIG DATA FROM> ex: $APP_NAME-$ENV_NAME or dimension"
def SWEAGLE_VALIDATORS = "<OPTIONAL, LIST OF CUSTOM VALIDATORS, SEPARATED BY SPACES, USED TO CHECK YOUR CONFIG> ex: noDevValues noEmptyValues passwordChecker"
def SWEAGLE_EXPORTER = "<EXPORTER USED TO RETRIEVE YOUR CONFIG> ex: all or returnDataForNode"
def SWEAGLE_EXPORTER_ARGS = "<OPTIONAL, EXPORTER ARGUMENTS IF ANY, SEPARATED BY COMMA> ex: node1"
def SWEAGLE_EXPORTER_FORMAT = "<OPTIONAL, FORMAT USED FOR DOWNLOADED CONFIG: PROPS (DEFAULT), YAML, JSON, XML> ex: JSON"
def SWEAGLE_EXPORTER_OUTPUT = "<OPTIONAL, TARGET FILE TO EXPORT CONFIG DATA TO, DEFAULT OUTPUT IS SCREEN> ex: /release/node1-conf.json"
def SWEAGLE_SNAPSHOT_TAG = "<OPTIONAL,TAG OF SNAPSHOT TO GET, DEFAULT IS LATEST SNAPSHOT> ex: v2"



// POST example
try {
    def body = '{"id": 120}'
    def http = new URL("http://localhost:8080/your/target/url").openConnection() as HttpURLConnection
    http.setRequestMethod('POST')
    http.setDoOutput(true)
    http.setRequestProperty("Accept", 'application/json')
    http.setRequestProperty("Content-Type", 'application/json')

    http.outputStream.write(body.getBytes("UTF-8"))
    http.connect()

    def response = [:]

    if (http.responseCode == 200) {
        response = new JsonSlurper().parseText(http.inputStream.getText('UTF-8'))
    } else {
        response = new JsonSlurper().parseText(http.errorStream.getText('UTF-8'))
    }

    println "response: ${response}"

} catch (Exception e) {
    // handle exception, e.g. Host unreachable, timeout etc.
}
